define(["jquery","core/ajax","core/str","require"],function(a,b,c,d){var e;return e={mconfig:null,CSS:{BOUNDINGCLASS:".openstudio-view-deleted-dialogue",VIEW_DELETED_BUTTON:"#id_viewdeletedpostbutton",RESTORE_BUTTON:".openstudio-restore-deleted-button"},init:function(b){e.mconfig=b,Y.use("moodle-core-notification-dialogue",function(){d(["mod_openstudio/osdialogue"],function(a){e.dialogue=e.createDeletedPostDialogue(a)})}),a(e.CSS.VIEW_DELETED_BUTTON).on("click",function(){e.dialogue&&(e.dialogue.show(),e.resize())}),a("body").delegate(e.CSS.RESTORE_BUTTON,"click",e.restoreContent),a(window).resize(e.resize.bind(e))},createDeletedPostDialogue:function(a){function d(){c.get_string("folderdeletedposts","mod_openstudio").done(function(a){g.set("headerContent","<span>"+a+"</span>")})}function f(){M.util.js_pending("openstudioFetchDeletedContent");var a=b.call([{methodname:"mod_openstudio_external_fetch_deleted_posts_in_folder",args:{cmid:e.mconfig.cmid,folderid:e.mconfig.folderid}}]);a[0].done(function(a){g.set("bodyContent",a)}).always(function(){M.util.js_complete("openstudioFetchDeletedContent")}).fail(function(a){window.console.error("Log request failed "+a.message)})}var g=new a({closeButton:!0,visible:!1,centered:!0,modal:!0,responsive:!0,width:640,responsiveWidth:767,focusOnPreviousTargetAfterHide:!0,extraClasses:[e.CSS.BOUNDINGCLASS.replace(".",""),"openstudio-folder-posts-dialogue"]});return d(),f(),g},restoreContent:function(){var c=a(this).data("content-version-id");c=parseInt(c),M.util.js_pending("openstudioRestoreContent");var d=b.call([{methodname:"mod_openstudio_external_restore_content_in_folder",args:{cmid:e.mconfig.cmid,cvid:c,folderid:e.mconfig.folderid}}]);d[0].done(function(){window.location.reload()}).always(function(){M.util.js_complete("openstudioRestoreContent")}).fail(function(a){window.console.error("Log request failed "+a.message)})},resize:function(){e.dialogue&&e.dialogue.get("visible")&&(Y.one("body").get("winWidth")<e.dialogue.get("responsiveWidth")?(e.dialogue.makeResponsive(),a(e.CSS.RESTORE_BUTTON).removeClass("osep-smallbutton")):(a(e.CSS.RESTORE_BUTTON).addClass("osep-smallbutton"),Y.one("body").get("winWidth")>=1e3?e.dialogue.set("width",640):e.dialogue.set("width",500),e.dialogue.centerDialogue()))}}});
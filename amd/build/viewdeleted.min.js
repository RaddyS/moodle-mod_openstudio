define(["jquery","core/ajax","core/str","core/templates","require"],function(a,b,c,d,e){var f;return f={mconfig:null,CSS:{BOUNDINGCLASS:".openstudio-view-deleted-dialogue",VIEW_DELETED_BUTTON:"#id_viewdeletedpostbutton",RESTORE_BUTTON:".openstudio-restore-deleted-button"},init:function(b){f.mconfig=b,Y.use("moodle-core-notification-dialogue",function(){e(["mod_openstudio/osdialogue"],function(a){f.dialogue=f.createDeletedPostDialogue(a)})}),a(f.CSS.VIEW_DELETED_BUTTON).on("click",function(){f.dialogue&&(f.dialogue.show(),f.resize())}),a("body").delegate(f.CSS.RESTORE_BUTTON,"click",f.restoreContent),a(window).resize(f.resize.bind(f))},createDeletedPostDialogue:function(a){function b(){c.get_string("folderdeletedposts","mod_openstudio").done(function(a){g.set("headerContent","<span>"+a+"</span>")})}function e(){d.render("mod_openstudio/viewdeleted_dialog",{deletedposts:f.mconfig.deletedposts}).done(function(a){g.set("bodyContent",a)})}var g=new a({closeButton:!0,visible:!1,centered:!0,modal:!0,responsive:!0,width:640,responsiveWidth:767,focusOnPreviousTargetAfterHide:!0,extraClasses:[f.CSS.BOUNDINGCLASS.replace(".",""),"openstudio-folder-posts-dialogue"]});return b(),e(),g},restoreContent:function(){var c=a(this).data("content-version-id");c=parseInt(c),M.util.js_pending("openstudioRestoreContent");var d=b.call([{methodname:"mod_openstudio_external_restore_content_in_folder",args:{cmid:f.mconfig.cmid,cvid:c,folderid:f.mconfig.folderid}}]);d[0].done(function(){window.location.reload()}).always(function(){M.util.js_complete("openstudioRestoreContent")}).fail(function(a){window.console.error("Log request failed "+a.message)})},resize:function(){f.dialogue&&f.dialogue.get("visible")&&(Y.one("body").get("winWidth")<f.dialogue.get("responsiveWidth")?(f.dialogue.makeResponsive(),a(f.CSS.RESTORE_BUTTON).removeClass("osep-smallbutton")):(a(f.CSS.RESTORE_BUTTON).addClass("osep-smallbutton"),Y.one("body").get("winWidth")>=1e3?f.dialogue.set("width",640):f.dialogue.set("width",500),f.dialogue.centerDialogue()))}}});
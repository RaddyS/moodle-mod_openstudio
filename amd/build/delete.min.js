define(["jquery","core/ajax","core/str","core/config","require"],function(a,b,c,d,e){var f;return f={mconfig:null,CSS:{DELETEBUTTON:"#id_deletebutton",DIALOGHEADER:".openstudio-dialogue-common-header",DELETEDIALOGUECONTAINER:".openstudio-delete-dialogue"},init:function(b){f.mconfig=b,Y.use("moodle-core-notification-dialogue",function(){e(["mod_openstudio/osdialogue"],function(a){f.dialogue=f.createDeleteDialogue(a)})}),a(f.CSS.DELETEBUTTON).on("click",function(){f.dialogue&&f.dialogue.show()}),a(window).resize(f.resize.bind(f))},createDeleteDialogue:function(a){function b(){var a=f.mconfig.isfolder?"folderdeletedfolder":"contentdeledialogueteheader";c.get_string(a,"mod_openstudio").done(function(a){g.set("headerContent",'<span class="'+f.CSS.DIALOGHEADER.replace(".","")+'">'+a+"</span>")})}function d(){var a=f.mconfig.isfolder?"deleteconfirmfolder":"deleteconfirmcontent";c.get_string(a,"mod_openstudio").done(function(a){g.set("bodyContent",a)})}function e(){var a={name:"cancel",classNames:"openstudio-delete-cancel-btn",action:"hide"},b={name:"delete",classNames:"openstudio-delete-ok-btn",events:{click:f.deleteContent.bind(f)}};c.get_strings([{key:"modulejsdialogcancel",component:"mod_openstudio"},{key:"deletelevel",component:"mod_openstudio"}]).done(function(c){a.label=c[0],b.label=c[1],g.addButton(b,["footer"]),g.addButton(a,["footer"])})}var g=new a({closeButton:!0,visible:!1,centered:!0,modal:!0,responsive:!0,width:640,responsiveWidth:767,focusOnPreviousTargetAfterHide:!0,extraClasses:[f.CSS.DELETEDIALOGUECONTAINER.replace(".","")]});return b(),d(),e(),g},deleteContent:function(){M.util.js_pending("openstudioDeleteContent");var a=b.call([{methodname:"mod_openstudio_external_delete_content",args:{id:f.mconfig.id,cid:f.mconfig.cid,containingfolder:f.mconfig.folderid}}]);a[0].done(function(a){var b="";b=f.mconfig.folderid?d.wwwroot+"/mod/openstudio/folder.php?sid="+f.mconfig.folderid:d.wwwroot+"/mod/openstudio/view.php?vid="+a.vid,b+="&id="+f.mconfig.id,window.location.href=b}).always(function(){M.util.js_complete("openstudioDeleteContent")}).fail(function(a){window.console.error("Log request failed "+a.message)})},resize:function(){f.dialogue&&f.dialogue.get("visible")&&(Y.one("body").get("winWidth")<=f.dialogue.get("responsiveWidth")?f.dialogue.makeResponsive():f.dialogue.centerDialogue())}}});